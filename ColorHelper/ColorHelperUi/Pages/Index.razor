@page "/"
@using ColorService
@using ColorService.Models
@using MudBlazor.Utilities
@inject IColorService ColorService
@inject HttpClient HttpClient

<PageTitle>Find Closest Paints</PageTitle>

<MudColorPicker PickerVariant="PickerVariant.Static" DisableAlpha="true" DisablePreview="true" ValueChanged="GetClosestPaints"/>

@if (ClosestPaints.Any())
{
    <MudSimpleTable>
        <thead>
                <tr>
                    <th>Brand</th>
                    <th>Name</th>
                    <th>Sample</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var paint in ClosestPaints)
                {
                    <tr>
                        <td>@paint.Brand</td>
                        <td>@paint.Name</td>
                        <td style="background-color: rgb(@paint.Rgb.R, @paint.Rgb.G, @paint.Rgb.B)"></td>
                    </tr>
                }
            </tbody>
    </MudSimpleTable>
}
@code {

    private IList<Paint> ClosestPaints { get; set; } = new List<Paint>();
    
    private async void GetClosestPaints(MudColor selectedColor)
    {
        ClosestPaints = await ColorService.GetClosestPaints(selectedColor.R, selectedColor.G,selectedColor.B);
    }
}